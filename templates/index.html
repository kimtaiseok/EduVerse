<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LogiCore Tech - 신입 개발자 학습 환경</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.1/full/pyodide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/typed.js@2.0.16/dist/typed.umd.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/editor/editor.main.css"
    />
    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body
    id="page-body"
    class="bg-gray-900 text-gray-300 font-sans h-screen overflow-hidden"
  >
    <div
      id="loading-indicator"
      class="w-full h-full flex flex-col items-center justify-center"
    >
      <p id="loading-text" class="text-white">
        파이썬 실행 환경을 준비 중입니다. 잠시만 기다려주세요...
      </p>
    </div>

    <div
      id="auth-container"
      class="w-full h-full flex flex-col items-center justify-center hidden"
    >
      <div
        class="w-full max-w-md bg-gray-800 p-8 rounded-lg shadow-2xl border border-gray-700"
      >
        <h1 class="text-3xl font-bold text-white text-center">LogiCore Tech</h1>
        <p class="text-center text-gray-400 mt-2">학습 관리 시스템</p>
        <form id="login-form" class="mt-8 space-y-6">
          <div>
            <label for="login-email" class="text-sm font-bold text-gray-400"
              >이메일</label
            ><input
              id="login-email"
              name="email"
              type="email"
              required
              class="w-full mt-2 p-3 bg-gray-700 rounded-md text-white"
            />
          </div>
          <div>
            <label for="login-password" class="text-sm font-bold text-gray-400"
              >비밀번호</label
            ><input
              id="login-password"
              name="password"
              type="password"
              required
              class="w-full mt-2 p-3 bg-gray-700 rounded-md text-white"
            />
          </div>
          <button
            type="submit"
            class="w-full py-3 px-4 bg-indigo-600 hover:bg-indigo-700 rounded-md text-white font-bold"
          >
            로그인
          </button>
          <p class="text-center text-sm">
            계정이 없으신가요?
            <a
              href="#"
              id="show-signup"
              class="font-semibold text-indigo-400 hover:underline"
              >회원가입</a
            >
          </p>
        </form>
        <form id="signup-form" class="mt-8 space-y-6 hidden">
          <div>
            <label for="signup-name" class="text-sm font-bold text-gray-400"
              >이름</label
            ><input
              id="signup-name"
              name="name"
              type="text"
              required
              class="w-full mt-2 p-3 bg-gray-700 rounded-md text-white"
            />
          </div>
          <div>
            <label for="signup-email" class="text-sm font-bold text-gray-400"
              >이메일</label
            ><input
              id="signup-email"
              name="email"
              type="email"
              required
              class="w-full mt-2 p-3 bg-gray-700 rounded-md text-white"
            />
          </div>
          <div>
            <label for="signup-password" class="text-sm font-bold text-gray-400"
              >비밀번호</label
            ><input
              id="signup-password"
              name="password"
              type="password"
              required
              class="w-full mt-2 p-3 bg-gray-700 rounded-md text-white"
            />
          </div>
          <div>
            <label for="signup-role" class="text-sm font-bold text-gray-400"
              >역할</label
            ><select
              id="signup-role"
              name="role"
              class="w-full mt-2 p-3 bg-gray-700 rounded-md text-white"
            >
              <option value="student">학습자 (Student)</option>
              <option value="instructor">교수자 (Instructor)</option>
            </select>
          </div>
          <button
            type="submit"
            class="w-full py-3 px-4 bg-green-600 hover:bg-green-700 rounded-md text-white font-bold"
          >
            회원가입
          </button>
          <p class="text-center text-sm">
            이미 계정이 있으신가요?
            <a
              href="#"
              id="show-login"
              class="font-semibold text-indigo-400 hover:underline"
              >로그인</a
            >
          </p>
        </form>
        <div id="auth-message" class="mt-4 text-center text-sm"></div>
      </div>
    </div>

    <div
      id="start-screen"
      class="w-full min-h-screen flex-col p-4 md:p-8 hidden overflow-y-auto"
    >
      <header
        class="w-full max-w-6xl mx-auto flex justify-between items-center mb-4"
      >
        <div>
          <h1
            class="font-planner text-5xl md:text-7xl text-white drop-shadow-lg"
          >
            My First Planner
          </h1>
          <p id="planner-date" class="text-white/80 text-base md:text-xl"></p>
        </div>
        <div class="flex items-center space-x-4 z-10">
          <span
            id="user-info"
            class="text-white bg-black/20 px-3 py-1 rounded-full text-sm md:text-base"
          ></span>
          <button
            id="logout-btn"
            class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg text-sm"
          >
            로그아웃
          </button>
        </div>
      </header>

      <div class="w-full max-w-6xl mx-auto">
        <div class="mt-4 grid grid-cols-1 lg:grid-cols-3 gap-6">
          <div class="lg:col-span-2 space-y-6">
            <div
              id="today-task-widget"
              class="planner-widget p-6 rounded-2xl"
            ></div>
            <button
              id="start-task-btn"
              class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-6 rounded-2xl flex items-center justify-center space-x-3 text-2xl shadow-lg transform hover:scale-105 transition-transform"
            ></button>

            <div class="planner-widget p-6 rounded-2xl">
              <h2
                class="font-planner text-4xl text-green-300 flex items-center"
              >
                <i data-lucide="map" class="w-8 h-8 mr-2"></i>Curriculum Roadmap
              </h2>
              <div
                id="curriculum-roadmap"
                class="mt-4 grid grid-cols-2 md:grid-cols-4 gap-2 text-center"
              ></div>
            </div>
          </div>

          <div class="space-y-6">
            <div class="planner-widget p-6 rounded-2xl">
              <h2
                class="font-planner text-4xl text-yellow-300 flex items-center"
              >
                <i data-lucide="check-square" class="w-8 h-8 mr-2"></i>My
                Activity
              </h2>
              <div id="learning-log" class="mt-2 space-y-1 text-lg"></div>
            </div>
            <div class="planner-widget p-4 md:p-6 rounded-2xl space-y-2">
              <button
                id="my-questions-btn"
                class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center justify-center space-x-2"
              >
                <i data-lucide="message-square"></i><span>내 질문 보기</span>
              </button>
              <button
                id="view-growth-btn"
                class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-2 px-4 rounded-lg flex items-center justify-center space-x-2"
              >
                <i data-lucide="trending-up"></i><span>나의 성장 기록</span>
              </button>
              <button
                id="level-setting-btn"
                class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg flex items-center justify-center space-x-2"
              >
                <i data-lucide="sliders-horizontal"></i
                ><span>학습 레벨 설정</span>
              </button>
              <button
                id="join-class-btn"
                class="w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-lg flex items-center justify-center space-x-2"
              >
                <i data-lucide="users"></i><span>수업 참여하기</span>
              </button>
              <div
                id="current-class-info"
                class="hidden text-center text-sm text-gray-400 mt-2 bg-gray-700/50 p-2 rounded-lg"
              >
                <p><strong>참여 중인 수업:</strong></p>
                <p id="current-class-name" class="font-semibold text-white"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="dashboard" class="flex flex-col h-full hidden">
      <div class="hidden md:flex flex-grow h-full">
        <aside
          id="dashboard-left"
          class="w-3/12 bg-gray-900/50 p-6 flex flex-col space-y-6 overflow-y-auto"
        ></aside>
        <main
          id="dashboard-main"
          class="w-6/12 flex flex-col p-6 h-full"
        ></main>
        <aside
          id="dashboard-right"
          class="w-3/12 bg-gray-900/50 p-6 flex flex-col overflow-y-auto"
        ></aside>
      </div>
      <div class="flex-grow md:hidden overflow-y-auto p-4 space-y-4">
        <div id="mobile-panel-task" class="hidden"></div>
        <div id="mobile-panel-code" class="h-full flex flex-col"></div>
        <div id="mobile-panel-syntax" class="hidden"></div>
      </div>
      <div
        class="md:hidden flex justify-around bg-gray-900 border-t border-gray-700"
      >
        <button
          id="mobile-tab-task"
          class="mobile-tab flex flex-col items-center justify-center"
        >
          <i data-lucide="clipboard-list"></i><span class="text-xs">과업</span>
        </button>
        <button
          id="mobile-tab-code"
          class="mobile-tab active flex flex-col items-center justify-center"
        >
          <i data-lucide="code"></i><span class="text-xs">코드</span>
        </button>
        <button
          id="mobile-tab-syntax"
          class="mobile-tab flex flex-col items-center justify-center"
        >
          <i data-lucide="book-marked"></i><span class="text-xs">문법</span>
        </button>
      </div>

      <button
        onclick="handleAction('ask_question', event)"
        class="fixed bottom-8 right-8 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-full z-[40] shadow-lg flex items-center space-x-2"
      >
        <i data-lucide="help-circle" class="w-6 h-6"></i>
        <span class="hidden md:block">교수님께 질문하기</span>
      </button>
    </div>

    <div id="modal-container" class="hidden fixed inset-0 z-50">
      <div
        id="modal-bg"
        class="absolute inset-0 bg-cover bg-center transition-all duration-500"
      ></div>
      <div class="absolute inset-0 bg-black/60"></div>
      <div id="modal-content-wrapper" class="relative w-full h-full"></div>
    </div>

    <div id="instructor-dashboard" class="w-full h-full p-4 md:p-8 hidden">
      <header
        class="w-full max-w-6xl mx-auto flex justify-between items-center mb-8"
      >
        <h1 class="text-3xl md:text-4xl font-bold text-white">
          수업 관리 대시보드
        </h1>
        <div class="flex items-center space-x-4">
          <span
            id="instructor-user-info"
            class="text-white text-sm md:text-base"
          ></span>
          <button
            id="instructor-logout-btn"
            class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg text-sm"
          >
            로그아웃
          </button>
        </div>
      </header>
      <div class="w-full max-w-6xl mx-auto">
        <div class="flex justify-end">
          <button
            id="create-class-btn"
            class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg flex items-center justify-center space-x-2"
          >
            <i data-lucide="plus-circle"></i><span>새 수업 개설</span>
          </button>
        </div>
        <div
          class="mt-8 bg-gray-800/50 p-4 md:p-6 rounded-lg border border-gray-700"
        >
          <h2 class="text-2xl font-bold text-white">내 수업 목록</h2>
          <div id="class-list" class="mt-4 space-y-4">
            <p class="text-gray-500">아직 개설한 수업이 없습니다.</p>
          </div>
        </div>
      </div>
    </div>

    <div
      id="create-class-modal"
      class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70"
    >
      <div
        class="bg-gray-800 rounded-lg shadow-2xl w-full max-w-2xl flex flex-col border border-gray-700"
      >
        <div
          class="p-4 border-b border-gray-700 flex justify-between items-center"
        >
          <h2 class="text-2xl font-bold text-white">새 수업 개설</h2>
          <button
            id="close-create-class-modal-btn"
            class="text-gray-400 hover:text-white"
          >
            <i data-lucide="x" class="w-6 h-6"></i>
          </button>
        </div>
        <form id="create-class-form" class="flex-grow p-6 space-y-4">
          <div>
            <label for="class-subject" class="text-sm font-bold text-gray-400"
              >교과명</label
            >
            <input
              id="class-subject"
              name="subject"
              type="text"
              required
              class="w-full mt-2 p-3 bg-gray-700 rounded-md text-white"
              placeholder="예: 파이썬 프로그래밍"
            />
          </div>
          <div>
            <label
              for="class-department"
              class="text-sm font-bold text-gray-400"
              >학과명</label
            >
            <input
              id="class-department"
              name="department"
              type="text"
              required
              class="w-full mt-2 p-3 bg-gray-700 rounded-md text-white"
              placeholder="예: 컴퓨터공학과"
            />
          </div>
          <div class="grid grid-cols-3 gap-4">
            <div>
              <label for="class-year" class="text-sm font-bold text-gray-400"
                >학년도</label
              >
              <input
                id="class-year"
                name="year"
                type="number"
                required
                class="w-full mt-2 p-3 bg-gray-700 rounded-md text-white"
                value="2025"
              />
            </div>
            <div>
              <label
                for="class-semester"
                class="text-sm font-bold text-gray-400"
                >학기</label
              >
              <select
                id="class-semester"
                name="semester"
                class="w-full mt-2 p-3 bg-gray-700 rounded-md text-white"
              >
                <option value="1학기">1학기</option>
                <option value="2학기">2학기</option>
                <option value="여름학기">여름학기</option>
                <option value="겨울학기">겨울학기</option>
              </select>
            </div>
            <div>
              <label for="class-section" class="text-sm font-bold text-gray-400"
                >분반</label
              >
              <input
                id="class-section"
                name="section"
                type="text"
                required
                class="w-full mt-2 p-3 bg-gray-700 rounded-md text-white"
                placeholder="예: 01"
              />
            </div>
          </div>
          <div
            id="create-class-message"
            class="mt-2 text-sm text-red-400"
          ></div>
          <div class="flex justify-end pt-4">
            <button
              type="submit"
              class="w-full py-3 px-4 bg-green-600 hover:bg-green-700 rounded-md text-white font-bold"
            >
              수업 생성하기
            </button>
          </div>
        </form>
      </div>
    </div>

    <div
      id="my-questions-modal"
      class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70"
    >
      <div
        class="bg-gray-800 rounded-lg shadow-2xl w-full max-w-4xl h-[80vh] flex flex-col border border-gray-700"
      >
        <div
          class="p-4 border-b border-gray-700 flex justify-between items-center"
        >
          <h2 class="text-2xl font-bold text-white">내 질문 및 답변</h2>
          <button
            id="close-my-questions-modal-btn"
            class="text-gray-400 hover:text-white"
          >
            <i data-lucide="x" class="w-6 h-6"></i>
          </button>
        </div>
        <div
          id="my-questions-list"
          class="flex-grow p-6 space-y-4 overflow-y-auto"
        >
          <p class="text-gray-400">질문 목록을 불러오는 중입니다...</p>
        </div>
      </div>
    </div>

    <div
      id="level-setting-modal"
      class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70"
    >
      <div
        class="bg-gray-800 rounded-lg shadow-2xl w-full max-w-md flex flex-col border border-gray-700"
      >
        <div
          class="p-4 border-b border-gray-700 flex justify-between items-center"
        >
          <h2 class="text-xl font-bold text-white">학습 레벨 설정</h2>
          <button
            id="close-level-modal-btn"
            class="text-gray-400 hover:text-white"
          >
            <i data-lucide="x" class="w-6 h-6"></i>
          </button>
        </div>
        <div class="p-6 space-y-4">
          <p class="text-sm text-gray-400">
            자신의 파이썬 학습 경험에 맞춰 레벨을 선택해주세요. 선택한 레벨에
            따라 일부 과제의 내용과 시작 코드가 달라질 수 있습니다.
          </p>
          <div class="space-y-2">
            <label
              class="flex items-center p-3 bg-gray-700 rounded-md cursor-pointer hover:bg-gray-600"
            >
              <input
                type="radio"
                name="user_level"
                value="beginner"
                class="form-radio text-indigo-500 h-5 w-5 mr-3"
              />
              <div>
                <span class="font-semibold text-white">초보자 (Beginner)</span>
                <p class="text-xs text-gray-400">
                  파이썬이 처음이거나 익숙하지 않아요.
                </p>
              </div>
            </label>
            <label
              class="flex items-center p-3 bg-gray-700 rounded-md cursor-pointer hover:bg-gray-600"
            >
              <input
                type="radio"
                name="user_level"
                value="advanced"
                class="form-radio text-indigo-500 h-5 w-5 mr-3"
              />
              <div>
                <span class="font-semibold text-white">경험자 (Advanced)</span>
                <p class="text-xs text-gray-400">
                  파이썬 기본 문법(변수, 조건문, 반복문, 함수 등)을 알고 있어요.
                </p>
              </div>
            </label>
          </div>
          <div id="level-setting-message" class="text-sm text-center"></div>
        </div>
        <div class="p-4 border-t border-gray-700 flex justify-end">
          <button
            id="save-level-btn"
            class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-lg"
          >
            저장
          </button>
        </div>
      </div>
    </div>
    <div
      id="answer-notification"
      class="hidden fixed bottom-8 right-8 z-[60] cursor-pointer"
    >
      <div class="relative">
        <img
          id="notification-char-img"
          src=""
          class="w-20 h-20 rounded-full border-4 border-indigo-500 shadow-lg animate-bounce"
        />
        <div
          class="absolute -top-2 -right-2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white font-bold"
        >
          !
        </div>
      </div>
      <div
        id="notification-bubble"
        class="mt-2 bg-indigo-500 text-white p-3 rounded-lg shadow-lg text-center font-semibold"
      ></div>
    </div>

    <template id="dashboard-left-template">
      <div
        class="task-widget-content bg-gray-800 p-4 rounded-lg border border-gray-700"
      ></div>
      <div class="bg-gray-800 p-4 rounded-lg border border-gray-700 flex-grow">
        <h3 class="font-bold text-lg text-white flex items-center">
          <i
            data-lucide="notebook-text"
            class="w-5 h-5 mr-2 text-yellow-400"
          ></i
          >지식 노트
        </h3>
        <div
          id="knowledge-note-content"
          class="notes-content-area-content mt-2 text-sm text-gray-400"
        >
          <p>아직 확인한 강의 노트가 없습니다.</p>
        </div>
      </div>
      <div>
        <button
          class="hint-btn-action w-full bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg flex items-center justify-center space-x-2 mb-2"
        >
          <i data-lucide="lightbulb" class="w-4 h-4"></i
          ><span>강의회상(수업듣기)</span>
        </button>
        <button
          onclick="handleAction('pause_task')"
          class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg flex items-center justify-center space-x-2"
        >
          <i data-lucide="pause-circle" class="w-4 h-4"></i
          ><span>일시정지 후 나가기</span>
        </button>
      </div>
    </template>
    <template id="dashboard-main-template">
      <div
        class="flex-grow bg-gray-900 rounded-lg border border-gray-700 flex flex-col h-full"
      >
        <div
          class="editor-filename-content bg-gray-800 p-2 border-b border-gray-700 text-sm text-white"
        ></div>
        <div
          class="code-editor-content p-1 font-mono text-sm flex-grow h-1/2"
        ></div>
        <div
          class="h-1/3 bg-black border-t border-gray-700 p-4 font-mono text-sm overflow-y-auto"
        >
          <p class="text-gray-500">&gt; 터미널 출력:</p>
          <pre class="terminal-output-content whitespace-pre-wrap"></pre>
        </div>
      </div>
      <div class="mt-6 flex space-x-4">
        <button
          class="run-code-btn-action w-1/2 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center space-x-2"
        >
          <i data-lucide="play" class="w-5 h-5"></i><span>코드 실행</span>
        </button>
        <button
          class="submit-btn-action w-1/2 bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center space-x-2"
        >
          <i data-lucide="send" class="w-5 h-5"></i><span>코드 제출</span>
        </button>
      </div>
    </template>
    <template id="dashboard-right-template">
      <div class="bg-gray-800 p-4 rounded-lg border border-gray-700 flex-grow">
        <h3 class="font-bold text-lg text-white flex items-center">
          <i data-lucide="book-marked" class="w-5 h-5 mr-2 text-cyan-400"></i
          >문법 인덱스
        </h3>
        <p class="text-xs text-gray-500">이번 과업에 필요한 도구들입니다.</p>
        <div class="syntax-index-content mt-4 space-y-2"></div>
      </div>
    </template>

    <script type="importmap">
      {
        "imports": {
          "firebase/app": "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js",
          "firebase/firestore": "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"
        }
      }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>

    <script type="module" src="/static/main.js"></script>
  </body>
</html>
